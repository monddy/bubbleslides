/*!
 * bubbleslides - jQuery plugin
 * @version: 1.5.0 - (2011/04/10)
 * @author Monddy (monddy.na@gmail.com)
 * Copyright (c) 2011 ASYP (http://www.asyp.com)
 * Licensed under the GPL (LICENSE) licens.
 * Requires: jQuery v1.4+
 */
!function(a){a.fn.bubbleslides=function(b){function q(b,c,d){if(n.tooltip){o=a("<div><p>"+k[b]+"</p>"+"<p>"+l[b]+"</p>"+"<p>"+m[b]+"</p>"+"</div>").css({fontFamily:n.fontFamily,color:n.color,fontSize:n.fontSize,fontWeight:n.fontWeight,position:"absolute",zIndex:1e5}).remove().addClass("pluginTip").css({top:0,left:0,visibility:"hidden",display:"block",border:"solid #ccc 3px",backgroundColor:"#fafafa",padding:"0 5px"}).appendTo(document.body);var e=a.extend({},c.offset(),{width:d.offsetWidth,height:d.offsetHeight}),h=(o[0].offsetWidth,o[0].offsetHeight);o.stop().css({top:e.top+e.height-h,left:3>b?e.left+1.5*e.width:e.left-2*e.width,visibility:"visible"}).animate({top:"-="+(n.scale/2-p/2)},n.inSpeed)}c.stop().animate({left:-n.scale/2+p/2,top:-n.scale/2+p/2,width:n.scale},n.inSpeed),c.closest("ul").next("ul").find("li").each(function(c,d){c==b&&a(d).animate({marginRight:"12px",marginLeft:"263px"},"fast").clearQueue(),a(d).animate({marginRight:"12px"},"fast").clearQueue()}),c.closest("ul").next("ul").find("img").each(function(c,d){a(d).attr("src",g[c+5*b]),a(d).closest("li").find(".subTip").text("￥"+j[c+5*b])})}function r(b,c){n.tooltip&&1!=a(".pluginTip").length&&a(".pluginTip").first().remove(),c.stop().animate({left:0,top:0,width:p},n.outSpeed,function(){c.css({"z-index":0})}),c.closest("ul").next("ul").find("li").each(function(c,d){c==b&&a(d).animate({marginRight:"12px",marginLeft:"0px"},"fast").clearQueue(),a(d).animate({marginRight:"12px"},"fast").clearQueue()})}function s(b,c){n.tooltip&&o&&o.remove(),c.stop().animate({left:0,top:0,width:p},n.outSpeed,function(){c.css({"z-index":0})}),c.closest("ul").next("ul").find("li").each(function(b,c){a(c).stop().animate({marginRight:"38px",marginLeft:"0"},"fast").clearQueue()}),c.closest("ul").next("ul").find("img").each(function(b,c){a(c).attr("src",f[b]),a(c).closest("li").find(".subTip").text("￥"+i[b])})}var t,u,v,c=this,d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=a.extend({},a.fn.bubbleslides.defaults,b),o=null,p=null;return a.ajax({url:n.xmlUrl,dataType:"xml",async:!1,success:function(b){a(b).find("product").each(function(b,c){var q,r,s,n=a(c).find("model").attr("normal"),o=a(c).find("model").attr("link"),p=a(c).find("item").eq(0).attr("url");a(c).find("thumbList").find("item").each(function(){g.push(a(this).attr("url")),h.push(a(this).attr("link"))}),a(c).find("thumbList").each(function(){i.push(a(this).find("price").first().text())}),a(c).find("thumbList").find("item").each(function(){j.push(a(this).find("price").text())}),q=a(c).find("priceTab").find("label").text(),r=a(c).find("priceTab").find("pddr").text(),s=a(c).find("priceTab").find("price").text(),d.push(n),e.push(o),f.push(p),k.push(q),l.push(r),m.push(s)})}}),c.each(function(b,c){a(c).attr("src",d[b]),a(c).closest("a").attr("href",e[b])}),c.closest("ul").next("ul").find("img").each(function(b,c){a(c).attr("src",f[b]),a(c).closest("a").attr("href",h[b]),a(c).closest("a").attr("target","blank"),a(c).closest("li").append('<div class="subTip" style="position:absolute;left:0;bottom:4px;width:100%;background-color:#333;color:#fff;display:none;text-align:center;filter:alpha(opacity=60);opacity:0.6;">￥'+i[b]+"</div>"),n.tooltip&&a(c).closest("li").hover(function(){a(this).find(".subTip").css("display","block")},function(){a(this).find(".subTip").css("display","none")})}),t=c.length,u=n.startItem,v=null,n.autoPlay&&(v=setInterval(function(){q(u,a(c[u]),c[u]),0==u?r(t-1,a(c[t-1])):r(u-1,a(c[u-1])),u=u>=t-1?0:++u},n.pInterval)),this.each(function(b){p=a(this).width(),a(this).mouseover(function(){clearInterval(v),q(b,a(this),this),u==b+1||u==b-5?1!=a(".pluginTip").length&&a(".pluginTip").last().remove():0==u?r(t-1,a(c[t-1])):r(u-1,a(c[u-1]))}).mouseout(function(){s(b,a(this)),a(".pluginTip").first().remove(),clearInterval(v),n.autoPlay&&(v=setInterval(function(){q(u,a(c[u]),c[u]),0==u?r(t-1,a(c[t-1])):r(u-1,a(c[u-1])),u=u>=t-1?0:++u},n.pInterval))})})},a.fn.bubbleslides.defaults={xmlUrl:"productList.xml",tooltip:!0,autoPlay:!0,scale:155,fontFamily:"microsoft YaHei",color:"#333333",fontSize:12,fontWeight:"bold",inSpeed:"slow",outSpeed:"fast",pInterval:5e3,startItem:0}}(jQuery);